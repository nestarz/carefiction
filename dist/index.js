(()=>{let f$=Object.hasOwnProperty,h$={},j$,k$=a$=>{let b$=h$[a$];return b$||(b$=h$[a$]={exports:{}},j$[a$](b$.exports,b$)),b$.exports},l$=a$=>{if(a$&&a$.__esModule)return a$;let b$={};for(let c$ in a$)f$.call(a$,c$)&&(b$[c$]=a$[c$]);return b$.default=a$,b$},p$=a$=>l$(k$(a$));j$={15(){var n,R,J,Z,la,ma,_,na,C={},K=[],Wa=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i;function A(a,b){for(var c in b)a[c]=b[c];return a}function oa(a){var b=a.parentNode;b&&b.removeChild(a)}function h(a,b,c){var d,f=arguments,e={};for(d in b)"key"!==d&&"ref"!==d&&(e[d]=b[d]);if(arguments.length>3)for(c=[c],d=3;d<arguments.length;d++)c.push(f[d]);if(null!=c&&(e.children=c),"function"==typeof a&&null!=a.defaultProps)for(d in a.defaultProps)void 0===e[d]&&(e[d]=a.defaultProps[d]);return L(a,e,b&&b.key,b&&b.ref,null)}function L(a,b,c,d,f){var e={type:a,props:b,key:c,ref:d,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,constructor:void 0,__v:f};return null==f&&(e.__v=e),n.vnode&&n.vnode(e),e}function Xa(){return{}}function x(a){return a.children}function M(a,b){this.props=a,this.context=b}function N(a,b){if(null==b)return a.__?N(a.__,a.__.__k.indexOf(a)+1):null;for(var c;b<a.__k.length;b++)if(null!=(c=a.__k[b])&&null!=c.__e)return c.__e;return"function"==typeof a.type?N(a):null}function pa(a){var b,c;if(null!=(a=a.__)&&null!=a.__c){for(a.__e=a.__c.base=null,b=0;b<a.__k.length;b++)if(null!=(c=a.__k[b])&&null!=c.__e){a.__e=a.__c.base=c.__e;break}return pa(a)}}function S(a){(!a.__d&&(a.__d=!0)&&J.push(a)&&!Z++||ma!==n.debounceRendering)&&((ma=n.debounceRendering)||la)(Ya)}function Ya(){for(var a;Z=J.length;)a=J.sort(function(b,c){return b.__v.__b-c.__v.__b}),J=[],a.some(function(b){var c,d,f,e,i,k,j;b.__d&&(k=(i=(c=b).__v).__e,(j=c.__P)&&(d=[],(f=A({},i)).__v=f,e=$(j,i,f,c.__n,void 0!==j.ownerSVGElement,null,d,null==k?N(i):k),ua(d,i),e!=k&&pa(i)))})}function qa(a,b,c,d,f,e,i,k,j,l){var g,o,p,m,q,z,s,t,r,w=d&&d.__k||K,u=w.length;for(j==C&&(j=null!=i?i[0]:u?N(d,0):null),c.__k=[],g=0;g<b.length;g++)if(null!=(m=c.__k[g]=null==(m=b[g])||"boolean"==typeof m?null:"string"==typeof m||"number"==typeof m?L(null,m,null,null,m):Array.isArray(m)?L(x,{children:m},null,null,null):null!=m.__e||null!=m.__c?L(m.type,m.props,m.key,null,m.__v):m)){if(m.__=c,m.__b=c.__b+1,null===(p=w[g])||p&&m.key==p.key&&m.type===p.type)w[g]=void 0;else for(o=0;o<u;o++){if((p=w[o])&&m.key==p.key&&m.type===p.type){w[o]=void 0;break}p=null}if(q=$(a,m,p=p||C,f,e,i,k,j,l),(o=m.ref)&&p.ref!=o&&(t||(t=[]),p.ref&&t.push(p.ref,null,m),t.push(o,m.__c||q,m)),null!=q){if(null==s&&(s=q),r=void 0,void 0!==m.__d)r=m.__d,m.__d=void 0;else if(i==p||q!=j||null==q.parentNode){Q:if(null==j||j.parentNode!==a)a.appendChild(q),r=null;else{for(z=j,o=0;(z=z.nextSibling)&&o<u;o+=2)if(z==q)break Q;a.insertBefore(q,j),r=j}"option"==c.type&&(a.value="")}j=void 0!==r?r:q.nextSibling,"function"==typeof c.type&&(c.__d=j)}else j&&p.__e==j&&j.parentNode!=a&&(j=N(p))}if(c.__e=s,null!=i&&"function"!=typeof c.type)for(g=i.length;g--;)null!=i[g]&&oa(i[g]);for(g=u;g--;)null!=w[g]&&aa(w[g],w[g]);if(t)for(g=0;g<t.length;g++)va(t[g],t[++g],t[++g])}function ra(a){return null==a||"boolean"==typeof a?[]:Array.isArray(a)?K.concat.apply([],a.map(ra)):[a]}function Za(a,b,c,d,f){var e;for(e in c)"children"===e||"key"===e||e in b||T(a,e,null,c[e],d);for(e in b)f&&"function"!=typeof b[e]||"children"===e||"key"===e||"value"===e||"checked"===e||c[e]===b[e]||T(a,e,b[e],c[e],d)}function sa(a,b,c){"-"===b[0]?a.setProperty(b,c):a[b]="number"==typeof c&&!1===Wa.test(b)?c+"px":null==c?"":c}function T(a,b,c,d,f){var e,i,k,j,l;if(f?"className"===b&&(b="class"):"class"===b&&(b="className"),"style"===b)if(e=a.style,"string"==typeof c)e.cssText=c;else{if("string"==typeof d&&(e.cssText="",d=null),d)for(j in d)c&&j in c||sa(e,j,"");if(c)for(l in c)d&&c[l]===d[l]||sa(e,l,c[l])}else"o"===b[0]&&"n"===b[1]?(i=b!==(b=b.replace(/Capture$/,"")),k=b.toLowerCase(),b=(k in a?k:b).slice(2),c?(d||a.addEventListener(b,ta,i),(a.l||(a.l={}))[b]=c):a.removeEventListener(b,ta,i)):"list"!==b&&"tagName"!==b&&"form"!==b&&"type"!==b&&"size"!==b&&!f&&b in a?a[b]=null==c?"":c:"function"!=typeof c&&"dangerouslySetInnerHTML"!==b&&(b!==(b=b.replace(/^xlink:?/,""))?null==c||!1===c?a.removeAttributeNS("http://www.w3.org/1999/xlink",b.toLowerCase()):a.setAttributeNS("http://www.w3.org/1999/xlink",b.toLowerCase(),c):null==c||!1===c&&!/^ar/.test(b)?a.removeAttribute(b):a.setAttribute(b,c))}function ta(a){this.l[a.type](n.event?n.event(a):a)}function $(a,b,c,d,f,e,i,k,j){var l,g,o,p,m,q,z,s,t,r,w,u=b.type;if(void 0!==b.constructor)return null;(l=n.__b)&&l(b);try{Q:if("function"==typeof u){if(s=b.props,t=(l=u.contextType)&&d[l.__c],r=l?t?t.props.value:l.__:d,c.__c?z=(g=b.__c=c.__c).__=g.__E:("prototype"in u&&u.prototype.render?b.__c=g=new u(s,r):(b.__c=g=new M(s,r),g.constructor=u,g.render=$a),t&&t.sub(g),g.props=s,g.state||(g.state={}),g.context=r,g.__n=d,o=g.__d=!0,g.__h=[]),null==g.__s&&(g.__s=g.state),null!=u.getDerivedStateFromProps&&(g.__s==g.state&&(g.__s=A({},g.__s)),A(g.__s,u.getDerivedStateFromProps(s,g.__s))),p=g.props,m=g.state,o)null==u.getDerivedStateFromProps&&null!=g.componentWillMount&&g.componentWillMount(),null!=g.componentDidMount&&g.__h.push(g.componentDidMount);else{if(null==u.getDerivedStateFromProps&&s!==p&&null!=g.componentWillReceiveProps&&g.componentWillReceiveProps(s,r),!g.__e&&null!=g.shouldComponentUpdate&&!1===g.shouldComponentUpdate(s,g.__s,r)||b.__v===c.__v){for(g.props=s,g.state=g.__s,b.__v!==c.__v&&(g.__d=!1),g.__v=b,b.__e=c.__e,b.__k=c.__k,g.__h.length&&i.push(g),l=0;l<b.__k.length;l++)b.__k[l]&&(b.__k[l].__=b);break Q}null!=g.componentWillUpdate&&g.componentWillUpdate(s,g.__s,r),null!=g.componentDidUpdate&&g.__h.push(function(){g.componentDidUpdate(p,m,q)})}g.context=r,g.props=s,g.state=g.__s,(l=n.__r)&&l(b),g.__d=!1,g.__v=b,g.__P=a,l=g.render(g.props,g.state,g.context),null!=g.getChildContext&&(d=A(A({},d),g.getChildContext())),o||null==g.getSnapshotBeforeUpdate||(q=g.getSnapshotBeforeUpdate(p,m)),w=null!=l&&l.type==x&&null==l.key?l.props.children:l,qa(a,Array.isArray(w)?w:[w],b,c,d,f,e,i,k,j),g.base=b.__e,g.__h.length&&i.push(g),z&&(g.__E=g.__=null),g.__e=!1}else null==e&&b.__v===c.__v?(b.__k=c.__k,b.__e=c.__e):b.__e=_a(c.__e,b,c,d,f,e,i,j);(l=n.diffed)&&l(b)}catch(ka){b.__v=null,n.__e(ka,b,c)}return b.__e}function ua(a,b){n.__c&&n.__c(b,a),a.some(function(c){try{a=c.__h,c.__h=[],a.some(function(d){d.call(c)})}catch(d){n.__e(d,c.__v)}})}function _a(a,b,c,d,f,e,i,k){var j,l,g,o,p,m=c.props,q=b.props;if(f="svg"===b.type||f,null!=e){for(j=0;j<e.length;j++)if(null!=(l=e[j])&&((null===b.type?3===l.nodeType:l.localName===b.type)||a==l)){a=l,e[j]=null;break}}if(null==a){if(null===b.type)return document.createTextNode(q);a=f?document.createElementNS("http://www.w3.org/2000/svg",b.type):document.createElement(b.type,q.is&&{is:q.is}),e=null,k=!1}if(null===b.type)m!==q&&a.data!=q&&(a.data=q);else{if(null!=e&&(e=K.slice.call(a.childNodes)),g=(m=c.props||C).dangerouslySetInnerHTML,o=q.dangerouslySetInnerHTML,!k){if(null!=e)for(m={},p=0;p<a.attributes.length;p++)m[a.attributes[p].name]=a.attributes[p].value;(o||g)&&(o&&g&&o.__html==g.__html||(a.innerHTML=o&&o.__html||""))}Za(a,q,m,f,k),o?b.__k=[]:(j=b.props.children,qa(a,Array.isArray(j)?j:[j],b,c,d,"foreignObject"!==b.type&&f,e,i,C,k)),k||("value"in q&&void 0!==(j=q.value)&&j!==a.value&&T(a,"value",j,m.value,!1),"checked"in q&&void 0!==(j=q.checked)&&j!==a.checked&&T(a,"checked",j,m.checked,!1))}return a}function va(a,b,c){try{"function"==typeof a?a(b):a.current=b}catch(d){n.__e(d,c)}}function aa(a,b,c){var d,f,e;if(n.unmount&&n.unmount(a),(d=a.ref)&&(d.current&&d.current!==a.__e||va(d,null,b)),c||"function"==typeof a.type||(c=null!=(f=a.__e)),a.__e=a.__d=void 0,null!=(d=a.__c)){if(d.componentWillUnmount)try{d.componentWillUnmount()}catch(i){n.__e(i,b)}d.base=d.__P=null}if(d=a.__k)for(e=0;e<d.length;e++)d[e]&&aa(d[e],b,c);null!=f&&oa(f)}function $a(a,b,c){return this.constructor(a,c)}function ba(a,b,c){var d,f,e;n.__&&n.__(a,b),f=(d=c===_)?null:c&&c.__k||b.__k,a=h(x,null,[a]),e=[],$(b,(d?b:c||b).__k=a,f||C,C,void 0!==b.ownerSVGElement,c&&!d?[c]:f?null:b.childNodes.length?K.slice.call(b.childNodes):null,e,c||C,d),ua(e,a)}function ab(a,b){ba(a,b,_)}function ca(a,b){var c,d;for(d in(b=A(A({},a.props),b),arguments.length>2&&(b.children=K.slice.call(arguments,2)),c={},b))"key"!==d&&"ref"!==d&&(c[d]=b[d]);return L(a.type,c,b.key||a.key,b.ref||a.ref,null)}function wa(a){var b={},c={__c:"__cC"+na++,__:a,Consumer:function(d,f){return d.children(f)},Provider:function(d){var f,e=this;return this.getChildContext||(f=[],this.getChildContext=function(){return b[c.__c]=e,b},this.shouldComponentUpdate=function(i){e.props.value!==i.value&&f.some(function(k){k.context=i.value,S(k)})},this.sub=function(i){f.push(i);var k=i.componentWillUnmount;i.componentWillUnmount=function(){f.splice(f.indexOf(i),1),k&&k.call(i)}}),d.children}};return c.Consumer.contextType=c,c.Provider.__=c,c}n={__e:function(a,b){for(var c,d;b=b.__;)if((c=b.__c)&&!c.__)try{if(c.constructor&&null!=c.constructor.getDerivedStateFromError&&(d=!0,c.setState(c.constructor.getDerivedStateFromError(a))),null!=c.componentDidCatch&&(d=!0,c.componentDidCatch(a)),d)return S(c.__E=c)}catch(f){a=f}throw a}},R=function(a){return null!=a&&void 0===a.constructor},M.prototype.setState=function(a,b){var c;c=this.__s!==this.state?this.__s:this.__s=A({},this.state),"function"==typeof a&&(a=a(c,this.props)),a&&A(c,a),null!=a&&this.__v&&(b&&this.__h.push(b),S(this))},M.prototype.forceUpdate=function(a){this.__v&&(this.__e=!0,a&&this.__h.push(a),S(this))},M.prototype.render=x,J=[],Z=0,la="function"==typeof Promise?Promise.prototype.then.bind(Promise.resolve()):setTimeout,_=C,na=0;var E,y,xa,H=0,da=[],ya=n.__r,za=n.diffed,Aa=n.__c,Ba=n.unmount;function I(a,b){n.__h&&n.__h(y,a,H||b),H=0;var c=y.__H||(y.__H={__:[],__h:[]});return a>=c.__.length&&c.__.push({}),c.__[a]}function B(a){return H=1,Ca(Ea,a)}function Ca(a,b,c){var d=I(E++,2);return d.t=a,d.__c||(d.__c=y,d.__=[c?c(b):Ea(void 0,b),function(f){var e=d.t(d.__[0],f);d.__[0]!==e&&(d.__[0]=e,d.__c.setState({}))}]),d.__}function O(a,b){var c=I(E++,3);!n.__s&&ha(c.__H,b)&&(c.__=a,c.__H=b,y.__H.__h.push(c))}function ea(a,b){var c=I(E++,4);!n.__s&&ha(c.__H,b)&&(c.__=a,c.__H=b,y.__h.push(c))}function D(a){return H=5,P(function(){return{current:a}},[])}function bb(a,b,c){H=6,ea(function(){"function"==typeof a?a(b()):a&&(a.current=b())},null==c?c:c.concat(a))}function P(a,b){var c=I(E++,7);return ha(c.__H,b)?(c.__H=b,c.__h=a,c.__=a()):c.__}function fa(a,b){return H=8,P(function(){return a},b)}function Da(a){var b=y.context[a.__c],c=I(E++,9);return c.__c=a,b?(null==c.__&&(c.__=!0,b.sub(y)),b.props.value):a.__}function cb(a,b){n.useDebugValue&&n.useDebugValue(b?b(a):a)}function db(a){var b=I(E++,10),c=B();return b.__=a,y.componentDidCatch||(y.componentDidCatch=function(d){b.__&&b.__(d),c[1](d)}),[c[0],function(){c[1](void 0)}]}function eb(){da.some(function(a){if(a.__P)try{a.__H.__h.forEach(U),a.__H.__h.forEach(ga),a.__H.__h=[]}catch(b){return a.__H.__h=[],n.__e(b,a.__v),!0}}),da=[]}function U(a){"function"==typeof a.u&&a.u()}function ga(a){a.u=a.__()}function ha(a,b){return!a||b.some(function(c,d){return c!==a[d]})}function Ea(a,b){return"function"==typeof b?b(a):b}n.__r=function(a){ya&&ya(a),E=0;var b=(y=a.__c).__H;b&&(b.__h.forEach(U),b.__h.forEach(ga),b.__h=[])},n.diffed=function(a){za&&za(a);var b=a.__c;b&&b.__H&&b.__H.__h.length&&(1!==da.push(b)&&xa===n.requestAnimationFrame||((xa=n.requestAnimationFrame)||function(c){var d,f=function(){clearTimeout(e),cancelAnimationFrame(d),setTimeout(c)},e=setTimeout(f,100);"undefined"!=typeof window&&(d=requestAnimationFrame(f))})(eb))},n.__c=function(a,b){b.some(function(c){try{c.__h.forEach(U),c.__h=c.__h.filter(function(d){return!d.__||ga(d)})}catch(d){b.some(function(f){f.__h&&(f.__h=[])}),b=[],n.__e(d,c.__v)}}),Aa&&Aa(a,b)},n.unmount=function(a){Ba&&Ba(a);var b=a.__c;if(b&&b.__H)try{b.__H.__.forEach(U)}catch(c){n.__e(c,b.__v)}};const fb=({base:a=""}={})=>{const[b,c]=B(La(a)),d=D(b);O(()=>{lb();const e=()=>{const k=La(a);d.current!==k&&c(d.current=k)},i=["popstate","pushState","replaceState"];return i.map(k=>addEventListener(k,e)),e(),()=>i.map(k=>removeEventListener(k,e))},[]);const f=fa((e,i)=>history[i?"replaceState":"pushState"](0,0,a+e),[]);return[b,f]};let Ka=0;const lb=()=>Ka?void 0:(["pushState","replaceState"].map(a=>{const b=history[a];history[a]=function(){const c=b.apply(this,arguments),d=new Event(a);return d.arguments=arguments,dispatchEvent(d),c}}),Ka=1),La=(a,b=location.pathname)=>b.indexOf(a)?b:b.slice(a.length)||"/";function gb(a=kb){let b={};const c=d=>b[d]||(b[d]=a(d));return(d,f)=>{const{regexp:e,keys:i}=c(d||""),k=e.exec(f);if(!k)return[!1,null];const j=i.reduce((l,g,o)=>(l[g.name]=k[o+1],l),{});return[!0,j]}}const Ja=a=>a.replace(/([.+*?=^!:${}()[\]|/\\])/g,"\\$1"),jb=(a,b,c)=>{let d=a?"((?:[^\\/]+?)(?:\\/(?:[^\\/]+?))*)":"([^\\/]+?)";return b&&c&&(d="(?:\\/"+d+")"),d+(b?"?":"")},kb=a=>{const b=/:([A-Za-z0-9_]+)([?+*]?)/g;let c=null,d=0,f=[],e="";for(;(c=b.exec(a))!==null;){const[i,k,j]=c,l=j==="+"||j==="*",g=j==="?"||j==="*",o=g&&a[c.index-1]==="/"?1:0,p=a.substring(d,c.index-o);f.push({name:k}),d=b.lastIndex,e+=Ja(p)+jb(l,g,o)}return e+=Ja(a.substring(d)),{keys:f,regexp:new RegExp("^"+e+"(?:\\/)?$","i")}};const Fa=wa({}),Ga=({hook:a=fb,base:b="",matcher:c=gb()}={})=>({hook:a,base:b,matcher:c});const V=()=>{const a=Da(Fa);return a.v||(a.v=Ga())},W=()=>{const a=V();return a.hook(a)},Ha=a=>{const[b]=W();return V().matcher(a,b)},hb=a=>{const b=D(null),c=b.current||(b.current={v:Ga(a)});return h(Fa.Provider,{value:c,children:a.children})},ia=({path:a,match:b,component:c,children:d})=>{const f=Ha(a),[e,i]=b||f;return e?c?h(c,{params:i}):typeof d==="function"?d(i):d:null},Ia=a=>{const[,b]=W(),{base:c}=V(),d=a.href||a.to,{children:f,onClick:e}=a,i=fa(l=>{if(l.ctrlKey||l.metaKey||l.altKey||l.shiftKey||l.button!==0)return;l.preventDefault(),b(d),e&&e(l)},[d,e,b]),k={href:c+d,onClick:i,to:null},j=R(f)?f:h("a",a);return ca(j,k)},ib=({children:a,location:b})=>{const{matcher:c}=V(),[d]=W();a=Array.isArray(a)?a:[a];for(const f of a){let e=0;if(R(f)&&f.props.path&&(e=c(f.props.path,b||d))[0])return ca(f,{match:e})}return null},Ob=a=>{const[,b]=W();return ea(()=>{b(a.href||a.to)},[]),null};const Pb=Ha;const Va=a=>a.split("/").pop();const G=a=>{const[b,c]=B([]),d=(i,k)=>j=>{const l=a.get(k);return[...j.filter(g=>g.key!==Va(k)),{key:k,node:l,remove:()=>l.back().get(k).put(null),data:i}]},f=i=>k=>k.filter(j=>j.key!==Va(i)),e=(i,k)=>i?c(d(i,k)):c(f(k));return O(()=>{let i;return a.map().on((k,j,l,g)=>{i=g,e(k,j)}),()=>{i?.off(),c([])}},[a]),[b,i=>a.set(i)]},v=(a,b=void 0)=>{const[c,d]=B(b);return O(()=>{let f;return a.once(e=>d(e)),a.on((e,i,k,j)=>{f=j,d(e)}),()=>{f?.off(),d(b)}},[a]),[c,f=>a.put(f)]},mb=({peers:a,root:b})=>window.Gun({peers:a,localStorage:!1}).get(b);const X=(...a)=>a.flatMap(b=>b?typeof b==="string"?b:Object.entries(b).reduce((c,[d,f])=>f&&d?[...c,d]:c,[]):null).filter(b=>b).join(" "),Id=a=>{const b=typeof a==="string"?Date.parse(a):a,c=new Intl.DateTimeFormat("en",{year:"numeric"}).format(b),d=new Intl.DateTimeFormat("en",{month:"short"}).format(b),f=new Intl.DateTimeFormat("en",{day:"2-digit"}).format(b);return`${f} ${d} ${c}`},zb=a=>new Promise((b,c)=>{const d=new FileReader();d.readAsDataURL(a),d.onload=()=>b(d.result),d.onerror=f=>c(f)}),Oa=({data:{createdAt:a}},{data:{createdAt:b}})=>new Date(b)-new Date(a),ub=({data:{count:a}},{data:{count:b}})=>a-b;const pb=({node:a,remove:b,placeholder:c})=>{const[d,f]=v(a.get("current")),[e,i]=v(a.get("lock"),!0),k=D();return O(()=>{k.current&&(k.current.style.height="1px",k.current.style.height=10+k.current.scrollHeight+"px")},[d,e]),h(x,null,!e&&h("div",{className:"before-lock"},h("button",{onClick:b},"âœ•"),h("button",{className:X({lock:e}),onClick:()=>i(!e)},e?"ðŸ”’":"ðŸ”“")),e?h("div",{className:"textarea"},d):h("textarea",{ref:k,readOnly:e,placeholder:c,value:d,onChange:j=>{e||f(j.target.value)},onKeyPress:j=>{!e&&f(j.target.value),j.which==13&&!j.shiftKey&&j.preventDefault()}}))};const Ma=({node:a,placeholder:b,onEnter:c=()=>null,onFocus:d=()=>null,onBlur:f=()=>null})=>{const[e,i]=v(a.get("values").get(F).get("current")),[k,j]=v(a.get("values").get(F).get("lock")),[l,g]=v(a.get("values").get(F).get("count")),[o,p]=v(a.get("values").get(F).get("createdAt"));return h(x,null,h("input",{type:"text",readOnly:k,placeholder:b,value:e,onFocus:d,onBlur:f,onKeyPress:m=>{m.which==13&&(c(m),i(m.target.value),j(!0),g((l||0)+1),p(new Date().toISOString()),m.preventDefault())}}))};const vb=({node:a,lock:b,onClick:c})=>{const[d,f]=v(a.get("count")),[e]=v(a.get("current")),[i,k]=B(!1);return e&&h("button",{disabled:b,className:X({clicked:i}),onClick:j=>{b||(f((d||0)+1),c(j),k(!0))}},h("span",null,e),h("span",{className:"count"},d))};const Na=({node:a})=>{const[b]=G(a.get("values")),[c,d]=v(a.get(F).get("lock"));return b.sort(ub).reverse().map(({key:f,node:e})=>h(vb,{key:f,node:e,lock:c,onClick:()=>d(!0)}))};const ob=({node:a,remove:b})=>{const[c,d]=v(a.get("lock"),!0);return h(x,null,!c&&h("div",{className:"before-lock"},h("button",{onClick:b},"âœ•"),h("button",{className:X({lock:c}),onClick:()=>d(!c)},c?"ðŸ”’":"ðŸ”“")),h(Ma,{placeholder:"Write something...",node:a}),h(Na,{node:a}))};const qb=({node:a,remove:b,maxSizeKo:c=400,onClick:d})=>{const[f,e]=v(a.get("src")),[i,k]=v(a.get("lock"),!0),j=async l=>{const g=l.target.files[0],o=parseInt(g.size/1000);o>c?alert(`Image too big (${o} ko > ${c} ko)`):e(await zb(g))};return h(x,null,!i&&h("div",{className:"before-lock"},h("button",{onClick:b},"âœ•"),f&&h("button",{onClick:()=>k(!0)},i?"ðŸ”’":"ðŸ”“")),f?h("img",{onClick:d,src:f}):h("input",{onChange:j,type:"file",accept:"image/*"}))};const Y=a=>a||0,Qa=a=>a.reduce((b,[c,d,f],e)=>e===0?`M${Y(d)},${Y(f)}`:`${b}${c||"L"}${Y(d)},${Y(f)}`,""),wb=(a,b,c)=>{const d=a.getScreenCTM(),f=Object.assign(a.createSVGPoint(),{x:b,y:c}),{x:e,y:i}=f.matrixTransform(d.inverse());return[e,i]},xb=a=>[...a.matchAll(/([A-Z]-?\d*\.{0,1}\d+\.?-?\d*\.{0,1}\d+,-?\d*\.{0,1}\d+\.?-?\d*\.{0,1}\d+)/g)].map(b=>[b[0][0],...b[0].substring(1).split(",")].map(c=>+c?+c:c));let Ra=0;const rb=({node:a,remove:b})=>{const[c,d]=v(a.get("points")),[f,e]=v(a.get("lock")),[i,k]=v(a.get("non-editable")),j=P(()=>c?xb(c).slice(0).slice(-1600):[],[c]),l=P(()=>Qa(j),[j]),g=D(),o=D(),[p,m]=B(!1),[q,z]=B("M"),s=()=>m(r=>!r),t=({clientX:r,clientY:w})=>{const u=Date.now()-Ra;if(u>40)if(p){const[ka,Ab]=wb(g.current,r,w).map(Bb=>Math.floor(Bb));d(Qa([...j,[q,ka,Ab]])),z("L"),Ra=Date.now()}else z("M")};return h(x,null,!f&&h("div",{className:"before-lock"},h("button",{onClick:b},"âœ•"),h("button",{disabled:j.length<10,onClick:()=>e(!0)},f?"ðŸ”’":"ðŸ”“"),h("button",{onClick:()=>k(!i)},i?"â˜‰":"âœŽ")),i?h("svg",{viewBox:"0 0 1000 1000",namespace:"http://www.w3.org/2000/svg"},h("path",{"stroke-width":"3",d:l})):h("svg",{className:X({lock:f,editable:!i}),ref:g,viewBox:"0 0 1000 1000",namespace:"http://www.w3.org/2000/svg",onClick:s,onMouseMove:t,onTouchStart:s,onTouchEnd:s,onTouchMove:r=>t(r.touches[0])},h("path",{"stroke-width":"3",ref:o,d:l})))};const Pa={text:pb,blank:ob,image:qb,drawing:rb};const sb=({node:a})=>{const[b]=G(a.get("blocks"));return b.sort(Oa).reverse().map(({key:c,node:d,data:f,remove:e})=>h("article",{key:c,className:f.type},h(Pa[f.type],{node:d,remove:e})))},tb=({node:a,onUpdate:b=()=>null})=>{const[c,d]=G(a.get("blocks")),f=e=>{d({createdAt:new Date().toISOString(),type:e}),b(e)};return Object.keys(Pa).map(e=>h("button",{key:e,onClick:()=>f(e)},e))};const yb=({parent:a,node:b})=>{const[c]=G(b.get("titles").get("values")),d=c.map(({data:f})=>({...f})).reduce((f,e)=>f.count>e.count?f:e,{});return d.current&&h(Ia,{to:a?`/fiction/${a._.get}/chapter/${b._.get}/`:`/fiction/${b._.get}/`},h("span",null,d&&d.current),h("span",{className:"count"},d&&d.count))},Sa=({node:a,parent:b})=>{const[c]=G(a.get("chapters"));return c.sort(Oa).reverse().map(({key:d,node:f})=>h(yb,{key:d,parent:b,node:f}))},Ta=({parent:a,node:b})=>{const[c,d]=G(b.get("chapters")),[f,e]=B(!1),i=k=>{const j=new Date().toISOString(),l=d({createdAt:j});l.get("chapters").get("Intro").put({createdAt:j}).get("titles").get("values").get(F).put({createdAt:j,current:"Intro",count:1}),l.get("titles").get("values").get(F).put({createdAt:j,current:k,count:1})};return h("input",{readOnly:f,type:"text",placeholder:a?"Start a Chapter...":"Start a Fiction...",onKeyPress:k=>{!f&&k.which==13&&(i(k.target.value),e(!0),k.preventDefault())}})},Ua=({node:a,type:b})=>{const[c]=G(a.get("titles").get("values")),d=c.map(({data:i})=>({...i})).reduce((i,k)=>i.count>k.count?i:k,{}),f=`toggle-${b}`,e=D();return h(x,null,d.current&&h("div",null,h("input",{ref:e,type:"checkbox",id:f,class:"toggle hidden"}),h("label",{for:f},h("span",null,">"),h(Ma,{placeholder:d.current,node:a.get("titles"),onFocus:()=>e.current.checked=!0})),h("div",{className:"vote"},h(Na,{node:a.get("titles")}))))};const ja=({parent:a,node:b})=>{const c=D(),d=()=>{c.current.scrollTo({top:c.current.scrollHeight,behavior:"smooth"})},f=()=>{setTimeout(d),setTimeout(d,500)};return h(x,null,h("header",null,h(Ia,{to:"/"},"Care Fiction"),a&&h(Ua,{node:a,type:"fiction"}),h(Ua,{node:b,type:"chapter"})),h("main",{ref:c},h(sb,{node:b})),h("aside",null,h("input",{type:"checkbox",id:"toggle-add",class:"toggle hidden"}),h("label",{for:"toggle-add"},"Add"),h("div",{className:"details"},h(tb,{node:b,onUpdate:f}))),h("nav",null,h("input",{type:"checkbox",id:"toggle-list",class:"toggle hidden"}),a?h(x,null,h("label",{for:"toggle-list"},"Chapters"),h("div",{className:"details"},h(Sa,{parent:a,node:a}),h(Ta,{parent:a,node:a}))):h(x,null,h("label",{for:"toggle-list"},"Fictions"),h("div",{className:"details"},h(Sa,{node:b}),h(Ta,{node:b})))))};const F=new Date().toISOString();const nb=()=>{const a=mb({peers:["https://gun.eliasrhouzlane.com/gun","https://carefiction-gun.herokuapp.com/gun"],root:"table-carefiction-2"});return h(hb,{basepath:location.pathname},h(ib,null,h(ia,{path:"/fiction/:fictionKey/chapter/:chapterKey/"},({fictionKey:b,chapterKey:c})=>h(ja,{parent:a.get("chapters").get(b),node:a.get("chapters").get(b).get("chapters").get(c)})),h(ia,{path:"/fiction/:fictionKey/"},({fictionKey:b})=>h(ja,{parent:a.get("chapters").get(b),node:a.get("chapters").get(b).get("chapters").get("Intro")})),h(ia,{path:"/:rest*"},()=>h(ja,{node:a}))))};ba(h(nb),document.body.insertBefore(document.createElement("div"),document.body.firstChild))}};return k$(15)})();
