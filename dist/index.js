(()=>{let n$=Object.assign,f$=Object.hasOwnProperty,h$={},j$,k$=a$=>{let b$=h$[a$];return b$||(b$=h$[a$]={exports:{}},j$[a$](b$.exports,b$)),b$.exports},l$=a$=>{if(a$&&a$.__esModule)return a$;let b$={};for(let c$ in a$)f$.call(a$,c$)&&(b$[c$]=a$[c$]);return b$.default=a$,b$},p$=a$=>l$(k$(a$));j$={16(){var n,R,K,_,na,oa,$,pa,C={},L=[],Xa=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i;function B(a,b){for(var c in b)a[c]=b[c];return a}function qa(a){var b=a.parentNode;b&&b.removeChild(a)}function h(a,b,c){var d,f=arguments,e={};for(d in b)"key"!==d&&"ref"!==d&&(e[d]=b[d]);if(arguments.length>3)for(c=[c],d=3;d<arguments.length;d++)c.push(f[d]);if(null!=c&&(e.children=c),"function"==typeof a&&null!=a.defaultProps)for(d in a.defaultProps)void 0===e[d]&&(e[d]=a.defaultProps[d]);return M(a,e,b&&b.key,b&&b.ref,null)}function M(a,b,c,d,f){var e={type:a,props:b,key:c,ref:d,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,constructor:void 0,__v:f};return null==f&&(e.__v=e),n.vnode&&n.vnode(e),e}function Ya(){return{}}function v(a){return a.children}function N(a,b){this.props=a,this.context=b}function O(a,b){if(null==b)return a.__?O(a.__,a.__.__k.indexOf(a)+1):null;for(var c;b<a.__k.length;b++)if(null!=(c=a.__k[b])&&null!=c.__e)return c.__e;return"function"==typeof a.type?O(a):null}function ra(a){var b,c;if(null!=(a=a.__)&&null!=a.__c){for(a.__e=a.__c.base=null,b=0;b<a.__k.length;b++)if(null!=(c=a.__k[b])&&null!=c.__e){a.__e=a.__c.base=c.__e;break}return ra(a)}}function S(a){(!a.__d&&(a.__d=!0)&&K.push(a)&&!_++||oa!==n.debounceRendering)&&((oa=n.debounceRendering)||na)(Za)}function Za(){for(var a;_=K.length;)a=K.sort(function(b,c){return b.__v.__b-c.__v.__b}),K=[],a.some(function(b){var c,d,f,e,j,k,i;b.__d&&(k=(j=(c=b).__v).__e,(i=c.__P)&&(d=[],(f=B({},j)).__v=f,e=aa(i,j,f,c.__n,void 0!==i.ownerSVGElement,null,d,null==k?O(j):k),wa(d,j),e!=k&&ra(j)))})}function sa(a,b,c,d,f,e,j,k,i,l){var g,p,o,m,q,A,s,t,r,x=d&&d.__k||L,u=x.length;for(i==C&&(i=null!=j?j[0]:u?O(d,0):null),c.__k=[],g=0;g<b.length;g++)if(null!=(m=c.__k[g]=null==(m=b[g])||"boolean"==typeof m?null:"string"==typeof m||"number"==typeof m?M(null,m,null,null,m):Array.isArray(m)?M(v,{children:m},null,null,null):null!=m.__e||null!=m.__c?M(m.type,m.props,m.key,null,m.__v):m)){if(m.__=c,m.__b=c.__b+1,null===(o=x[g])||o&&m.key==o.key&&m.type===o.type)x[g]=void 0;else for(p=0;p<u;p++){if((o=x[p])&&m.key==o.key&&m.type===o.type){x[p]=void 0;break}o=null}if(q=aa(a,m,o=o||C,f,e,j,k,i,l),(p=m.ref)&&o.ref!=p&&(t||(t=[]),o.ref&&t.push(o.ref,null,m),t.push(p,m.__c||q,m)),null!=q){if(null==s&&(s=q),r=void 0,void 0!==m.__d)r=m.__d,m.__d=void 0;else if(j==o||q!=i||null==q.parentNode){Q:if(null==i||i.parentNode!==a)a.appendChild(q),r=null;else{for(A=i,p=0;(A=A.nextSibling)&&p<u;p+=2)if(A==q)break Q;a.insertBefore(q,i),r=i}"option"==c.type&&(a.value="")}i=void 0!==r?r:q.nextSibling,"function"==typeof c.type&&(c.__d=i)}else i&&o.__e==i&&i.parentNode!=a&&(i=O(o))}if(c.__e=s,null!=j&&"function"!=typeof c.type)for(g=j.length;g--;)null!=j[g]&&qa(j[g]);for(g=u;g--;)null!=x[g]&&ba(x[g],x[g]);if(t)for(g=0;g<t.length;g++)xa(t[g],t[++g],t[++g])}function ta(a){return null==a||"boolean"==typeof a?[]:Array.isArray(a)?L.concat.apply([],a.map(ta)):[a]}function _a(a,b,c,d,f){var e;for(e in c)"children"===e||"key"===e||e in b||T(a,e,null,c[e],d);for(e in b)f&&"function"!=typeof b[e]||"children"===e||"key"===e||"value"===e||"checked"===e||c[e]===b[e]||T(a,e,b[e],c[e],d)}function ua(a,b,c){"-"===b[0]?a.setProperty(b,c):a[b]="number"==typeof c&&!1===Xa.test(b)?c+"px":null==c?"":c}function T(a,b,c,d,f){var e,j,k,i,l;if(f?"className"===b&&(b="class"):"class"===b&&(b="className"),"style"===b)if(e=a.style,"string"==typeof c)e.cssText=c;else{if("string"==typeof d&&(e.cssText="",d=null),d)for(i in d)c&&i in c||ua(e,i,"");if(c)for(l in c)d&&c[l]===d[l]||ua(e,l,c[l])}else"o"===b[0]&&"n"===b[1]?(j=b!==(b=b.replace(/Capture$/,"")),k=b.toLowerCase(),b=(k in a?k:b).slice(2),c?(d||a.addEventListener(b,va,j),(a.l||(a.l={}))[b]=c):a.removeEventListener(b,va,j)):"list"!==b&&"tagName"!==b&&"form"!==b&&"type"!==b&&"size"!==b&&!f&&b in a?a[b]=null==c?"":c:"function"!=typeof c&&"dangerouslySetInnerHTML"!==b&&(b!==(b=b.replace(/^xlink:?/,""))?null==c||!1===c?a.removeAttributeNS("http://www.w3.org/1999/xlink",b.toLowerCase()):a.setAttributeNS("http://www.w3.org/1999/xlink",b.toLowerCase(),c):null==c||!1===c&&!/^ar/.test(b)?a.removeAttribute(b):a.setAttribute(b,c))}function va(a){this.l[a.type](n.event?n.event(a):a)}function aa(a,b,c,d,f,e,j,k,i){var l,g,p,o,m,q,A,s,t,r,x,u=b.type;if(void 0!==b.constructor)return null;(l=n.__b)&&l(b);try{Q:if("function"==typeof u){if(s=b.props,t=(l=u.contextType)&&d[l.__c],r=l?t?t.props.value:l.__:d,c.__c?A=(g=b.__c=c.__c).__=g.__E:("prototype"in u&&u.prototype.render?b.__c=g=new u(s,r):(b.__c=g=new N(s,r),g.constructor=u,g.render=ab),t&&t.sub(g),g.props=s,g.state||(g.state={}),g.context=r,g.__n=d,p=g.__d=!0,g.__h=[]),null==g.__s&&(g.__s=g.state),null!=u.getDerivedStateFromProps&&(g.__s==g.state&&(g.__s=B({},g.__s)),B(g.__s,u.getDerivedStateFromProps(s,g.__s))),o=g.props,m=g.state,p)null==u.getDerivedStateFromProps&&null!=g.componentWillMount&&g.componentWillMount(),null!=g.componentDidMount&&g.__h.push(g.componentDidMount);else{if(null==u.getDerivedStateFromProps&&s!==o&&null!=g.componentWillReceiveProps&&g.componentWillReceiveProps(s,r),!g.__e&&null!=g.shouldComponentUpdate&&!1===g.shouldComponentUpdate(s,g.__s,r)||b.__v===c.__v){for(g.props=s,g.state=g.__s,b.__v!==c.__v&&(g.__d=!1),g.__v=b,b.__e=c.__e,b.__k=c.__k,g.__h.length&&j.push(g),l=0;l<b.__k.length;l++)b.__k[l]&&(b.__k[l].__=b);break Q}null!=g.componentWillUpdate&&g.componentWillUpdate(s,g.__s,r),null!=g.componentDidUpdate&&g.__h.push(function(){g.componentDidUpdate(o,m,q)})}g.context=r,g.props=s,g.state=g.__s,(l=n.__r)&&l(b),g.__d=!1,g.__v=b,g.__P=a,l=g.render(g.props,g.state,g.context),null!=g.getChildContext&&(d=B(B({},d),g.getChildContext())),p||null==g.getSnapshotBeforeUpdate||(q=g.getSnapshotBeforeUpdate(o,m)),x=null!=l&&l.type==v&&null==l.key?l.props.children:l,sa(a,Array.isArray(x)?x:[x],b,c,d,f,e,j,k,i),g.base=b.__e,g.__h.length&&j.push(g),A&&(g.__E=g.__=null),g.__e=!1}else null==e&&b.__v===c.__v?(b.__k=c.__k,b.__e=c.__e):b.__e=$a(c.__e,b,c,d,f,e,j,i);(l=n.diffed)&&l(b)}catch(ma){b.__v=null,n.__e(ma,b,c)}return b.__e}function wa(a,b){n.__c&&n.__c(b,a),a.some(function(c){try{a=c.__h,c.__h=[],a.some(function(d){d.call(c)})}catch(d){n.__e(d,c.__v)}})}function $a(a,b,c,d,f,e,j,k){var i,l,g,p,o,m=c.props,q=b.props;if(f="svg"===b.type||f,null!=e){for(i=0;i<e.length;i++)if(null!=(l=e[i])&&((null===b.type?3===l.nodeType:l.localName===b.type)||a==l)){a=l,e[i]=null;break}}if(null==a){if(null===b.type)return document.createTextNode(q);a=f?document.createElementNS("http://www.w3.org/2000/svg",b.type):document.createElement(b.type,q.is&&{is:q.is}),e=null,k=!1}if(null===b.type)m!==q&&a.data!=q&&(a.data=q);else{if(null!=e&&(e=L.slice.call(a.childNodes)),g=(m=c.props||C).dangerouslySetInnerHTML,p=q.dangerouslySetInnerHTML,!k){if(null!=e)for(m={},o=0;o<a.attributes.length;o++)m[a.attributes[o].name]=a.attributes[o].value;(p||g)&&(p&&g&&p.__html==g.__html||(a.innerHTML=p&&p.__html||""))}_a(a,q,m,f,k),p?b.__k=[]:(i=b.props.children,sa(a,Array.isArray(i)?i:[i],b,c,d,"foreignObject"!==b.type&&f,e,j,C,k)),k||("value"in q&&void 0!==(i=q.value)&&i!==a.value&&T(a,"value",i,m.value,!1),"checked"in q&&void 0!==(i=q.checked)&&i!==a.checked&&T(a,"checked",i,m.checked,!1))}return a}function xa(a,b,c){try{"function"==typeof a?a(b):a.current=b}catch(d){n.__e(d,c)}}function ba(a,b,c){var d,f,e;if(n.unmount&&n.unmount(a),(d=a.ref)&&(d.current&&d.current!==a.__e||xa(d,null,b)),c||"function"==typeof a.type||(c=null!=(f=a.__e)),a.__e=a.__d=void 0,null!=(d=a.__c)){if(d.componentWillUnmount)try{d.componentWillUnmount()}catch(j){n.__e(j,b)}d.base=d.__P=null}if(d=a.__k)for(e=0;e<d.length;e++)d[e]&&ba(d[e],b,c);null!=f&&qa(f)}function ab(a,b,c){return this.constructor(a,c)}function ca(a,b,c){var d,f,e;n.__&&n.__(a,b),f=(d=c===$)?null:c&&c.__k||b.__k,a=h(v,null,[a]),e=[],aa(b,(d?b:c||b).__k=a,f||C,C,void 0!==b.ownerSVGElement,c&&!d?[c]:f?null:b.childNodes.length?L.slice.call(b.childNodes):null,e,c||C,d),wa(e,a)}function bb(a,b){ca(a,b,$)}function da(a,b){var c,d;for(d in(b=B(B({},a.props),b),arguments.length>2&&(b.children=L.slice.call(arguments,2)),c={},b))"key"!==d&&"ref"!==d&&(c[d]=b[d]);return M(a.type,c,b.key||a.key,b.ref||a.ref,null)}function ya(a){var b={},c={__c:"__cC"+pa++,__:a,Consumer:function(d,f){return d.children(f)},Provider:function(d){var f,e=this;return this.getChildContext||(f=[],this.getChildContext=function(){return b[c.__c]=e,b},this.shouldComponentUpdate=function(j){e.props.value!==j.value&&f.some(function(k){k.context=j.value,S(k)})},this.sub=function(j){f.push(j);var k=j.componentWillUnmount;j.componentWillUnmount=function(){f.splice(f.indexOf(j),1),k&&k.call(j)}}),d.children}};return c.Consumer.contextType=c,c.Provider.__=c,c}n={__e:function(a,b){for(var c,d;b=b.__;)if((c=b.__c)&&!c.__)try{if(c.constructor&&null!=c.constructor.getDerivedStateFromError&&(d=!0,c.setState(c.constructor.getDerivedStateFromError(a))),null!=c.componentDidCatch&&(d=!0,c.componentDidCatch(a)),d)return S(c.__E=c)}catch(f){a=f}throw a}},R=function(a){return null!=a&&void 0===a.constructor},N.prototype.setState=function(a,b){var c;c=this.__s!==this.state?this.__s:this.__s=B({},this.state),"function"==typeof a&&(a=a(c,this.props)),a&&B(c,a),null!=a&&this.__v&&(b&&this.__h.push(b),S(this))},N.prototype.forceUpdate=function(a){this.__v&&(this.__e=!0,a&&this.__h.push(a),S(this))},N.prototype.render=v,K=[],_=0,na="function"==typeof Promise?Promise.prototype.then.bind(Promise.resolve()):setTimeout,$=C,pa=0;var E,y,za,H=0,ea=[],Aa=n.__r,Ba=n.diffed,Ca=n.__c,Da=n.unmount;function I(a,b){n.__h&&n.__h(y,a,H||b),H=0;var c=y.__H||(y.__H={__:[],__h:[]});return a>=c.__.length&&c.__.push({}),c.__[a]}function z(a){return H=1,Ea(Ga,a)}function Ea(a,b,c){var d=I(E++,2);return d.t=a,d.__c||(d.__c=y,d.__=[c?c(b):Ga(void 0,b),function(f){var e=d.t(d.__[0],f);d.__[0]!==e&&(d.__[0]=e,d.__c.setState({}))}]),d.__}function J(a,b){var c=I(E++,3);!n.__s&&ia(c.__H,b)&&(c.__=a,c.__H=b,y.__H.__h.push(c))}function fa(a,b){var c=I(E++,4);!n.__s&&ia(c.__H,b)&&(c.__=a,c.__H=b,y.__h.push(c))}function D(a){return H=5,P(function(){return{current:a}},[])}function cb(a,b,c){H=6,fa(function(){"function"==typeof a?a(b()):a&&(a.current=b())},null==c?c:c.concat(a))}function P(a,b){var c=I(E++,7);return ia(c.__H,b)?(c.__H=b,c.__h=a,c.__=a()):c.__}function ga(a,b){return H=8,P(function(){return a},b)}function Fa(a){var b=y.context[a.__c],c=I(E++,9);return c.__c=a,b?(null==c.__&&(c.__=!0,b.sub(y)),b.props.value):a.__}function db(a,b){n.useDebugValue&&n.useDebugValue(b?b(a):a)}function eb(a){var b=I(E++,10),c=z();return b.__=a,y.componentDidCatch||(y.componentDidCatch=function(d){b.__&&b.__(d),c[1](d)}),[c[0],function(){c[1](void 0)}]}function fb(){ea.some(function(a){if(a.__P)try{a.__H.__h.forEach(U),a.__H.__h.forEach(ha),a.__H.__h=[]}catch(b){return a.__H.__h=[],n.__e(b,a.__v),!0}}),ea=[]}function U(a){"function"==typeof a.u&&a.u()}function ha(a){a.u=a.__()}function ia(a,b){return!a||b.some(function(c,d){return c!==a[d]})}function Ga(a,b){return"function"==typeof b?b(a):b}n.__r=function(a){Aa&&Aa(a),E=0;var b=(y=a.__c).__H;b&&(b.__h.forEach(U),b.__h.forEach(ha),b.__h=[])},n.diffed=function(a){Ba&&Ba(a);var b=a.__c;b&&b.__H&&b.__H.__h.length&&(1!==ea.push(b)&&za===n.requestAnimationFrame||((za=n.requestAnimationFrame)||function(c){var d,f=function(){clearTimeout(e),cancelAnimationFrame(d),setTimeout(c)},e=setTimeout(f,100);"undefined"!=typeof window&&(d=requestAnimationFrame(f))})(fb))},n.__c=function(a,b){b.some(function(c){try{c.__h.forEach(U),c.__h=c.__h.filter(function(d){return!d.__||ha(d)})}catch(d){b.some(function(f){f.__h&&(f.__h=[])}),b=[],n.__e(d,c.__v)}}),Ca&&Ca(a,b)},n.unmount=function(a){Da&&Da(a);var b=a.__c;if(b&&b.__H)try{b.__H.__.forEach(U)}catch(c){n.__e(c,b.__v)}};const gb=({base:a=""}={})=>{const[b,c]=z(Na(a)),d=D(b);J(()=>{mb();const e=()=>{const k=Na(a);d.current!==k&&c(d.current=k)},j=["popstate","pushState","replaceState"];return j.map(k=>addEventListener(k,e)),e(),()=>j.map(k=>removeEventListener(k,e))},[]);const f=ga((e,j)=>history[j?"replaceState":"pushState"](0,0,a+e),[]);return[b,f]};let Ma=0;const mb=()=>Ma?void 0:(["pushState","replaceState"].map(a=>{const b=history[a];history[a]=function(){const c=b.apply(this,arguments),d=new Event(a);return d.arguments=arguments,dispatchEvent(d),c}}),Ma=1),Na=(a,b=location.pathname)=>b.indexOf(a)?b:b.slice(a.length)||"/";function hb(a=lb){let b={};const c=d=>b[d]||(b[d]=a(d));return(d,f)=>{const{regexp:e,keys:j}=c(d||""),k=e.exec(f);if(!k)return[!1,null];const i=j.reduce((l,g,p)=>(l[g.name]=k[p+1],l),{});return[!0,i]}}const La=a=>a.replace(/([.+*?=^!:${}()[\]|/\\])/g,"\\$1"),kb=(a,b,c)=>{let d=a?"((?:[^\\/]+?)(?:\\/(?:[^\\/]+?))*)":"([^\\/]+?)";return b&&c&&(d="(?:\\/"+d+")"),d+(b?"?":"")},lb=a=>{const b=/:([A-Za-z0-9_]+)([?+*]?)/g;let c=null,d=0,f=[],e="";for(;(c=b.exec(a))!==null;){const[j,k,i]=c,l=i==="+"||i==="*",g=i==="?"||i==="*",p=g&&a[c.index-1]==="/"?1:0,o=a.substring(d,c.index-p);f.push({name:k}),d=b.lastIndex,e+=La(o)+kb(l,g,p)}return e+=La(a.substring(d)),{keys:f,regexp:new RegExp("^"+e+"(?:\\/)?$","i")}};const Ha=ya({}),Ia=({hook:a=gb,base:b="",matcher:c=hb()}={})=>({hook:a,base:b,matcher:c});const V=()=>{const a=Fa(Ha);return a.v||(a.v=Ia())},W=()=>{const a=V();return a.hook(a)},Ja=a=>{const[b]=W();return V().matcher(a,b)},ib=a=>{const b=D(null),c=b.current||(b.current={v:Ia(a)});return h(Ha.Provider,{value:c,children:a.children})},X=({path:a,match:b,component:c,children:d})=>{const f=Ja(a),[e,j]=b||f;return e?c?h(c,{params:j}):typeof d==="function"?d(j):d:null},Ka=a=>{const[,b]=W(),{base:c}=V(),d=a.href||a.to,{children:f,onClick:e}=a,j=ga(l=>{if(l.ctrlKey||l.metaKey||l.altKey||l.shiftKey||l.button!==0)return;l.preventDefault(),b(d),e&&e(l)},[d,e,b]),k={href:c+d,onClick:j,to:null},i=R(f)?f:h("a",a);return da(i,k)},jb=({children:a,location:b})=>{const{matcher:c}=V(),[d]=W();a=Array.isArray(a)?a:[a];for(const f of a){let e=0;if(R(f)&&f.props.path&&(e=c(f.props.path,b||d))[0])return da(f,{match:e})}return null},Rb=a=>{const[,b]=W();return fa(()=>{b(a.href||a.to)},[]),null};const Sb=Ja;const Wa=a=>a.split("/").pop();const G=a=>{const[b,c]=z([]),d=(j,k)=>i=>{const l=a.get(k);return[...i.filter(g=>g.key!==Wa(k)),{key:k,node:l,remove:()=>l.back().get(k).put(null),data:j}]},f=j=>k=>k.filter(i=>i.key!==Wa(j)),e=(j,k)=>j?c(d(j,k)):c(f(k));return J(()=>{let j;return a.map().on((k,i,l,g)=>{j=g,e(k,i)}),()=>{j&&j.off(),c([])}},[a]),[b,j=>a.set(j)]},w=(a,b=void 0)=>{const[c,d]=z(b);return J(()=>{let f;return a.once(e=>d(e)),a.on((e,j,k,i)=>{f=i,d(e)}),()=>{f&&f.off(),d(b)}},[a]),[c,f=>a.put(f)]},nb=({peers:a,root:b})=>window.Gun({peers:a,localStorage:!1}).get(b);const Y=(...a)=>a.flatMap(b=>b?typeof b==="string"?b:Object.entries(b).reduce((c,[d,f])=>f&&d?[...c,d]:c,[]):null).filter(b=>b).join(" "),Qd=a=>{const b=typeof a==="string"?Date.parse(a):a,c=new Intl.DateTimeFormat("en",{year:"numeric"}).format(b),d=new Intl.DateTimeFormat("en",{month:"short"}).format(b),f=new Intl.DateTimeFormat("en",{day:"2-digit"}).format(b);return`${f} ${d} ${c}`},Bb=a=>new Promise((b,c)=>{const d=new FileReader();d.readAsDataURL(a),d.onload=()=>b(d.result),d.onerror=f=>c(f)}),ka=({data:{createdAt:a}},{data:{createdAt:b}})=>new Date(b)-new Date(a),wb=({data:{count:a}},{data:{count:b}})=>a-b,la=a=>a.length*(3/4)/1000,Cb=(a,b)=>{const c=document.createElement("canvas"),d=document.createElement("img"),f=()=>Object.assign(c,{width:0,height:0});return new Promise((e,j)=>{d.onload=function(){let k=d.width,i=d.height;const l=600,g=600;k>i?k>g&&(i=Math.round(i*=g/k),k=g):i>l&&(k=Math.round(k*=l/i),i=l),c.width=k,c.height=i;const p=c.getContext("2d");p.drawImage(d,0,0,k,i);const o=c.toDataURL(b,.8);la(o)>300?e(c.toDataURL("image/jpeg",.7)):e(o),f()},d.onerror=function(k){j(k),f()},d.src=a})};const rb=({node:a,remove:b,placeholder:c})=>{const[d,f]=w(a.get("current")),[e,j]=w(a.get("lock"),!0),k=D();return J(()=>{k.current&&(k.current.style.height="1px",k.current.style.height=10+k.current.scrollHeight+"px")},[d,e]),h(v,null,!e&&h("div",{className:"before-lock"},h("button",{onClick:b},"✕"),h("button",{className:Y({lock:e}),onClick:()=>j(!e)},e?"🔒":"🔓")),e?h("div",{className:"textarea"},d):h("textarea",{ref:k,readOnly:e,placeholder:c,value:d,onChange:i=>{e||f(i.target.value)},onKeyPress:i=>{!e&&f(i.target.value),i.which==13&&!i.shiftKey&&i.preventDefault()}}))};const Oa=({node:a,placeholder:b,onEnter:c=()=>null,onFocus:d=()=>null,onBlur:f=()=>null})=>{const[e,j]=w(a.get("values").get(F).get("current")),[k,i]=w(a.get("values").get(F).get("lock")),[l,g]=w(a.get("values").get(F).get("count")),[p,o]=w(a.get("values").get(F).get("createdAt"));return h(v,null,h("input",{type:"text",readOnly:k,placeholder:b,value:e,onFocus:d,onBlur:f,onKeyPress:m=>{m.which==13&&(c(m),j(m.target.value),i(!0),g((l||0)+1),o(new Date().toISOString()),m.preventDefault())}}))};const xb=({node:a,lock:b,onClick:c})=>{const[d,f]=w(a.get("count")),[e]=w(a.get("current")),[j,k]=z(!1);return e&&h("button",{disabled:b,className:Y({clicked:j}),onClick:i=>{b||(f((d||0)+1),c(i),k(!0))}},h("span",null,e),h("span",{className:"count"},d))};const Pa=({node:a})=>{const[b]=G(a.get("values")),[c,d]=w(a.get(F).get("lock"));return b.sort(ka).sort(wb).reverse().map(({key:f,node:e})=>h(xb,{key:f,node:e,lock:c,onClick:()=>d(!0)}))};const qb=({node:a,remove:b})=>{const[c,d]=w(a.get("lock"),!0);return h(v,null,!c&&h("div",{className:"before-lock"},h("button",{onClick:b},"✕"),h("button",{className:Y({lock:c}),onClick:()=>d(!c)},c?"🔒":"🔓")),h(Oa,{placeholder:"Write something...",node:a}),h(Pa,{node:a}))};const sb=({node:a,remove:b,maxSizeKo:c=400,onClick:d})=>{const[f,e]=w(a.get("src")),[j,k]=w(a.get("lock"),!0),i=async l=>{const g=l.target.files[0],p=await Bb(g).then(m=>la(m)>c?Cb(m,g.type):m),o=la(p);o>c?alert(`Image too big (${o} ko > ${c} ko)`):e(p)};return h(v,null,!j&&h("div",{className:"before-lock"},h("button",{onClick:b},"✕"),f&&h("button",{onClick:()=>k(!0)},j?"🔒":"🔓")),f?h("img",{onClick:d,src:f}):h("input",{onChange:i,type:"file",accept:"image/*"}))};const Z=a=>a||0,Ra=a=>a.reduce((b,[c,d,f],e)=>e===0?`M${Z(d)},${Z(f)}`:`${b}${c||"L"}${Z(d)},${Z(f)}`,""),yb=(a,b,c)=>{const d=a.getScreenCTM(),f=Object.assign(a.createSVGPoint(),{x:b,y:c}),{x:e,y:j}=f.matrixTransform(d.inverse());return[e,j]},zb=a=>[...a.matchAll(/([A-Z]-?\d*\.{0,1}\d+\.?-?\d*\.{0,1}\d+,-?\d*\.{0,1}\d+\.?-?\d*\.{0,1}\d+)/g)].map(b=>[b[0][0],...b[0].substring(1).split(",")].map(c=>+c?+c:c));let Sa=0;const tb=({node:a,remove:b})=>{const[c,d]=w(a.get("points")),[f,e]=w(a.get("lock")),[j,k]=w(a.get("non-editable")),i=P(()=>c?zb(c).slice(0).slice(-1600):[],[c]),l=P(()=>Ra(i),[i]),g=D(),p=D(),[o,m]=z(!1),[q,A]=z("M"),s=()=>m(r=>!r),t=({clientX:r,clientY:x})=>{const u=Date.now()-Sa;if(u>40)if(o){const[ma,Db]=yb(g.current,r,x).map(Eb=>Math.floor(Eb));d(Ra([...i,[q,ma,Db]])),A("L"),Sa=Date.now()}else A("M")};return h(v,null,!f&&h("div",{className:"before-lock"},h("button",{onClick:b},"✕"),h("button",{disabled:i.length<10,onClick:()=>e(!0)},f?"🔒":"🔓"),h("button",{onClick:()=>k(!j)},j?"☉":"✎")),j?h("svg",{viewBox:"0 0 1000 1000",namespace:"http://www.w3.org/2000/svg"},h("path",{"stroke-width":"3",d:l})):h("svg",{className:Y({lock:f,editable:!j}),ref:g,viewBox:"0 0 1000 1000",namespace:"http://www.w3.org/2000/svg",onClick:s,onMouseMove:t,onTouchStart:s,onTouchEnd:s,onTouchMove:r=>t(r.touches[0])},h("path",{"stroke-width":"3",ref:p,d:l})))};const Qa={text:rb,blank:qb,image:sb,drawing:tb};const ub=({node:a})=>{const[b]=G(a.get("blocks"));return b.sort(ka).reverse().map(({key:c,node:d,data:f,remove:e})=>h("article",{key:c,className:f.type},h(Qa[f.type],{node:d,remove:e})))},vb=({node:a,onUpdate:b=()=>null})=>{const[c,d]=G(a.get("blocks")),f=e=>{d({createdAt:new Date().toISOString(),type:e}),b(e)};return Object.keys(Qa).map(e=>h("button",{key:e,onClick:()=>f(e)},e))};const Ab=({parent:a,node:b})=>{const[c]=G(b.get("titles").get("values")),d=c.map(({data:f})=>n$({},f)).reduce((f,e)=>f.count>e.count?f:e,{});return d.current&&h(Ka,{to:a?`/fiction/${a._.get}/chapter/${b._.get}/`:`/fiction/${b._.get}/`},h("span",null,d&&d.current),h("span",{className:"count"},d&&d.count))},Ta=({node:a,parent:b})=>{const[c]=G(a.get("chapters"));return c.sort(ka).reverse().map(({key:d,node:f,remove:e})=>h(v,null,h(Ab,{key:d,parent:b,node:f})))},Ua=({parent:a,node:b})=>{const[c,d]=G(b.get("chapters")),[f,e]=z(!1),j=k=>{const i=new Date().toISOString(),l=d({createdAt:i});l.get("chapters").get("Intro").put({createdAt:i}).get("titles").get("values").get(F).put({createdAt:i,current:"Intro",count:1}),l.get("titles").get("values").get(F).put({createdAt:i,current:k,count:1})};return h("input",{readOnly:f,type:"text",placeholder:a?"Start a Chapter...":"Start a Fiction...",onKeyPress:k=>{!f&&k.which==13&&(j(k.target.value),e(!0),k.preventDefault())}})},Va=({node:a,type:b})=>{const[c]=G(a.get("titles").get("values")),d=c.map(({data:j})=>n$({},j)).reduce((j,k)=>j.count>k.count?j:k,{}),f=`toggle-${b}`,e=D();return h(v,null,d.current&&h("div",null,h("input",{ref:e,type:"checkbox",id:f,class:"toggle hidden"}),h("label",{for:f},h("span",null,">"),h(Oa,{placeholder:d.current,node:a.get("titles"),onFocus:()=>e.current.checked=!0})),h("div",{className:"vote"},h(Pa,{node:a.get("titles")}))))};const ja=({parent:a,node:b})=>{const c=D(),d=()=>{c.current.scrollTo({top:c.current.scrollHeight,behavior:"smooth"})},f=()=>{setTimeout(d),setTimeout(d,500)};return h(v,null,h("header",null,h(Ka,{to:"/"},"Care Fiction"),a&&h(Va,{node:a,type:"fiction"}),h(Va,{node:b,type:"chapter"})),h("main",{ref:c},h(ub,{node:b})),a&&h("aside",null,h("input",{type:"checkbox",id:"toggle-add",class:"toggle hidden"}),h("label",{for:"toggle-add"},"Add"),h("div",{className:"details"},h(vb,{node:b,onUpdate:f}))),h("nav",null,h("input",{type:"checkbox",id:"toggle-list",class:"toggle hidden"}),a?h(v,null,h("label",{for:"toggle-list"},"Chapters"),h("div",{className:"details"},h(Ta,{parent:a,node:a}),h(Ua,{parent:a,node:a}))):h(v,null,h("label",{for:"toggle-list"},"Fictions"),h("div",{className:"details"},h(Ta,{node:b}),h(Ua,{node:b})))))};const ob=({node:a})=>{const[b,c]=z(),[d,f]=z();return J(()=>{a.load(e=>{f(`care-fiction-${new Date().toISOString()}.json`),c(URL.createObjectURL(new Blob([JSON.stringify(e)],{type:"application/json"})))},{wait:99})},[a]),h("div",{className:"p2p-data-page"},h("a",{href:b},"Display"),h("a",{href:b,download:d},"Download"),h("span",null,"the database from the peers."))};const F=new Date().toISOString();const pb=()=>{const a=nb({peers:["https://gun.eliasrhouzlane.com/gun","https://carefiction-gun.herokuapp.com/gun"],root:"table-carefiction-2"});return h(ib,{basepath:location.pathname},h(jb,null,h(X,{path:"/fiction/:fictionKey/chapter/:chapterKey/"},({fictionKey:b,chapterKey:c})=>h(ja,{parent:a.get("chapters").get(b),node:a.get("chapters").get(b).get("chapters").get(c)})),h(X,{path:"/fiction/:fictionKey/"},({fictionKey:b})=>h(ja,{parent:a.get("chapters").get(b),node:a.get("chapters").get(b).get("chapters").get("Intro")})),h(X,{path:"/p2p/data/"},()=>h(ob,{node:a})),h(X,{path:"/:rest*"},()=>h(ja,{node:a}))))};ca(h(pb),document.body.insertBefore(document.createElement("div"),document.body.firstChild))}};return k$(16)})();
